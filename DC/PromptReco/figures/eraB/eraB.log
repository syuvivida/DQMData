

The period to process lumiloss plots is eraB
We will run step plot
The output csv/JSON files are in the directory eikotest




Steps include: all        --> running all steps (inputcsv, json, outputcsv, plot, dump)
               inputcsv   --> producing csv files for the input runs using brilcalc
               json       --> producing muon and golden JSON files
                              Note, only golden JSON files are required for the next step
                              If you lose connection to the DB after producing golden JSON file, you can move on to the next step
               outputcsv  --> producing run registry info for the input runs
               plot       --> make luminosity loss plots
               dump       --> dump the major lumi loss into text files


The directory /afs/cern.ch/user/s/syu/scripts/runregistry/eikotest exists.
The run list is Era/eraB_runs.txt
Python 3.6.12
Using base prefix '/opt/rh/rh-python36/root/usr'
New python executable in /afs/cern.ch/user/s/syu/scripts/runregistry/venv/bin/python3
Not overwriting existing python script /afs/cern.ch/user/s/syu/scripts/runregistry/venv/bin/python (you must use /afs/cern.ch/user/s/syu/scripts/runregistry/venv/bin/python3)
Installing setuptools, pip, wheel...done.
Running virtualenv with interpreter /opt/rh/rh-python36/root/usr/bin/python3
/afs/cern.ch/user/s/syu/scripts/runregistry
Requirement already satisfied: runregistry in ./venv/lib/python3.6/site-packages
Requirement already satisfied: requests in ./venv/lib/python3.6/site-packages (from runregistry)
Requirement already satisfied: cernrequests in ./venv/lib/python3.6/site-packages (from runregistry)
Requirement already satisfied: certifi>=2017.4.17 in ./venv/lib/python3.6/site-packages (from requests->runregistry)
Requirement already satisfied: idna<4,>=2.5; python_version >= "3" in ./venv/lib/python3.6/site-packages (from requests->runregistry)
Requirement already satisfied: charset-normalizer~=2.0.0; python_version >= "3" in ./venv/lib/python3.6/site-packages (from requests->runregistry)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in ./venv/lib/python3.6/site-packages (from requests->runregistry)
Requirement already satisfied: future in ./venv/lib/python3.6/site-packages (from cernrequests->runregistry)
You are using pip version 9.0.1, however version 22.3.1 is available.
You should consider upgrading via the 'pip install --upgrade pip' command.
Requirement already satisfied: matplotlib in ./venv/lib/python3.6/site-packages
Requirement already satisfied: kiwisolver>=1.0.1 in ./venv/lib/python3.6/site-packages (from matplotlib)
Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.3 in ./venv/lib/python3.6/site-packages (from matplotlib)
Requirement already satisfied: pillow>=6.2.0 in ./venv/lib/python3.6/site-packages (from matplotlib)
Requirement already satisfied: numpy>=1.15 in ./venv/lib/python3.6/site-packages (from matplotlib)
Requirement already satisfied: cycler>=0.10 in ./venv/lib/python3.6/site-packages (from matplotlib)
Requirement already satisfied: python-dateutil>=2.1 in ./venv/lib/python3.6/site-packages (from matplotlib)
Requirement already satisfied: six>=1.5 in ./venv/lib/python3.6/site-packages (from python-dateutil>=2.1->matplotlib)
You are using pip version 9.0.1, however version 22.3.1 is available.
You should consider upgrading via the 'pip install --upgrade pip' command.
figures_eraB directory exists.
moving the original figures_eraB to tmp
creating a new directory figures_eraB


Now we are going to produce lumiloss plots in eraB
using the input from eikotest/output_eraB.csv
['make_dc_plot.py', '-c', 'eikotest/output_eraB.csv', '-p', 'eraB', '-d', 'figures_eraB']
Total recorded luminosity for these runs is:  115.22972469709957 /pb
Total recorded luminosity loss for these runs is:  18.878473908885557 /pb
{'ecal-es': 6.45034082e-07, 'csc-csc': 0.21298056320730102, 'muon-muon': 0.21298056320730102, 'hcal-hcal': 0.248045924611942, 'l1t-l1tmu': 0.32595870699392804, 'l1t-l1tcalo': 0.7996952682284572, 'tracker-strip': 4.031337374340808, 'tracker-pixel': 4.10541339972935, 'tracker-track': 4.360271265960413, 'jetmet-jetmet': 13.435245444433402, 'egamma-egamma': 16.96946432526642}
{'ho_ready': 0.008930610159383, 'bpix_ready': 3.8026886147283703, 'tecm_ready': 3.83536884551921, 'tecp_ready': 3.844054259388885, 'tob_ready': 3.846975731584604, 'tibtid_ready': 3.847211676063874, 'fpix_ready': 3.852250259876393}
{'ECAL': 6.45034082e-07, 'Muon': 0.21298056320730102, 'HCAL': 0.25697653477132504, 'L1T': 0.8034143312265091, 'Tracker': 4.43626805235122, 'JetMET': 13.435245444433402, 'EGamma': 16.96946432526642}
{'HCAL EGamma ': 0.0015396697303529999, 'HCAL L1T JetMET EGamma ': 0.003099473213684, 'Tracker L1T JetMET ': 0.030059553566156, 'Tracker EGamma ': 0.046509132090843994, 'HCAL ': 0.05041826623943899, 'L1T ': 0.084978469028831, 'Tracker JetMET ': 0.127813081057567, 'L1T EGamma ': 0.15969376208097327, 'HCAL JetMET EGamma ': 0.20180748190303902, 'L1T JetMET EGamma ': 0.20371020309366897, 'Muon EGamma ': 0.21298056320730102, 'Tracker L1T JetMET EGamma ': 0.32160033459393983, 'Tracker ': 1.6157402137271322, 'Tracker JetMET EGamma ': 2.2942725566322446, 'EGamma ': 3.2712074963828317, 'JetMET EGamma ': 10.252770471654195}
{'HCAL ': 0.05041826623943899, 'L1T ': 0.084978469028831, 'Tracker ': 1.6157402137271322, 'EGamma ': 3.2712074963828317, 'Mixed': 13.85612946350731}
{'Tracker ': 0.08558637851371288, 'EGamma ': 0.17327711509790886, 'Mixed': 0.7339644894169982}
{'HCAL JetMET EGamma ': 1.0689819679124275, 'L1T JetMET EGamma ': 1.0790607549998437, 'Muon EGamma ': 1.1281662079001904, 'Tracker L1T JetMET EGamma ': 1.7035293008645778, 'Tracker ': 8.558637851371289, 'Tracker JetMET EGamma ': 12.152849683217223, 'EGamma ': 17.327711509790884, 'JetMET EGamma ': 54.30931822740454}
{'bpix_ready': 3.8026886147283703, 'tecm_ready': 3.83536884551921, 'tecp_ready': 3.844054259388885, 'tob_ready': 3.846975731584604, 'tibtid_ready': 3.847211676063874, 'fpix_ready': 3.852250259876393, 'tracker-strip': 4.031337374340808, 'tracker-pixel': 4.10541339972935, 'tracker-track': 4.360271265960413}
{'ecal-ecal': 0.0, 'ecal-es': 6.45034082e-07}
{'hbhea_ready': 0.0, 'hbheb_ready': 0.0, 'hbhec_ready': 0.0, 'hf_ready': 0.0, 'ho_ready': 0.008930610159383, 'hcal-hcal': 0.248045924611942}
{'dt-dt': 0.0, 'muon-muon': 0.21298056320730102, 'csc-csc': 0.21298056320730102}
{'l1t-l1tmu': 0.32595870699392804, 'l1t-l1tcalo': 0.7996952682284572}
{'hlt-hlt': 0.0}
{'jetmet-jetmet': 13.435245444433402}
{'egamma-egamma': 16.96946432526642}
defaultdict(<class 'str'>, {'Mixed': 'brown', 'Tracker ': 'purple', 'ECAL ': 'red', 'HCAL ': 'green', 'Muon ': 'orange', 'L1T ': 'blue', 'HLT ': 'pink', 'JetMET ': 'gray', 'EGamma ': 'olive'})
['Tracker ', 'EGamma ', 'Mixed']
The png files are in the directory /afs/cern.ch/user/s/syu/scripts/runregistry/figures_eraB
The script produce_lumilossplots.sh has produced luminosity loss plots and will stop now
