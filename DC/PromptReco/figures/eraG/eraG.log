

The period to process lumiloss plots is eraG
We will run step plot
The output csv/JSON files are in the directory Era




Steps include: all        --> running all steps (inputcsv, json, outputcsv, plot, dump)
The following options are only one step per job
               inputcsv   --> producing csv files for the input runs using brilcalc
               json       --> producing muon and golden JSON files
                              Note, only golden JSON files are required for the next step
                              If you lose connection to the DB after producing golden JSON file, you can move on to the next step
               outputcsv  --> producing run registry info for the input runs
               plot       --> make luminosity loss plots
               dump       --> dump the major lumi loss into text files


The following options run the job from step xx to the last step
               json_all       --> running json, outputcsv, plot, dump
               outputcsv_all  --> running outputcsv, plot, dump
               plot_all       --> running plot, dump


The directory /afs/cern.ch/user/s/syu/scripts/runregistry/Era exists.
The run list is Era/eraG_runs.txt
Python 3.6.12
Using base prefix '/opt/rh/rh-python36/root/usr'
New python executable in /afs/cern.ch/user/s/syu/scripts/runregistry/venv/bin/python3
Not overwriting existing python script /afs/cern.ch/user/s/syu/scripts/runregistry/venv/bin/python (you must use /afs/cern.ch/user/s/syu/scripts/runregistry/venv/bin/python3)
Installing setuptools, pip, wheel...done.
Running virtualenv with interpreter /opt/rh/rh-python36/root/usr/bin/python3
/afs/cern.ch/user/s/syu/scripts/runregistry
Requirement already satisfied: runregistry in ./venv/lib/python3.6/site-packages
Requirement already satisfied: requests in ./venv/lib/python3.6/site-packages (from runregistry)
Requirement already satisfied: cernrequests in ./venv/lib/python3.6/site-packages (from runregistry)
Requirement already satisfied: idna<4,>=2.5; python_version >= "3" in ./venv/lib/python3.6/site-packages (from requests->runregistry)
Requirement already satisfied: certifi>=2017.4.17 in ./venv/lib/python3.6/site-packages (from requests->runregistry)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in ./venv/lib/python3.6/site-packages (from requests->runregistry)
Requirement already satisfied: charset-normalizer~=2.0.0; python_version >= "3" in ./venv/lib/python3.6/site-packages (from requests->runregistry)
Requirement already satisfied: future in ./venv/lib/python3.6/site-packages (from cernrequests->runregistry)
You are using pip version 9.0.1, however version 22.3.1 is available.
You should consider upgrading via the 'pip install --upgrade pip' command.
Requirement already satisfied: matplotlib in ./venv/lib/python3.6/site-packages
Requirement already satisfied: numpy>=1.15 in ./venv/lib/python3.6/site-packages (from matplotlib)
Requirement already satisfied: kiwisolver>=1.0.1 in ./venv/lib/python3.6/site-packages (from matplotlib)
Requirement already satisfied: pillow>=6.2.0 in ./venv/lib/python3.6/site-packages (from matplotlib)
Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.3 in ./venv/lib/python3.6/site-packages (from matplotlib)
Requirement already satisfied: python-dateutil>=2.1 in ./venv/lib/python3.6/site-packages (from matplotlib)
Requirement already satisfied: cycler>=0.10 in ./venv/lib/python3.6/site-packages (from matplotlib)
Requirement already satisfied: six>=1.5 in ./venv/lib/python3.6/site-packages (from python-dateutil>=2.1->matplotlib)
You are using pip version 9.0.1, however version 22.3.1 is available.
You should consider upgrading via the 'pip install --upgrade pip' command.
creating a new directory figures_eraG


Now we are going to produce lumiloss plots in eraG
using the input from Era/output_eraG.csv
['make_dc_plot.py', '-c', 'Era/output_eraG.csv', '-p', 'eraG', '-d', 'figures_eraG']
Total recorded luminosity for these runs is:  3245.4164124389727 /pb
Total recorded luminosity loss for these runs is:  189.97031256645568 /pb
{'ecal-ecal': 0.105466069610327, 'tracker-track': 0.33140069754988, 'tracker-pixel': 4.16094468304367, 'tracker-strip': 4.58632363487294, 'hcal-hcal': 6.680559499607825, 'l1t-l1tmu': 14.114422092689713, 'l1t-l1tcalo': 14.114422092689713, 'jetmet-jetmet': 140.82375439199643, 'hlt-hlt': 150.2203147276383}
{'ho_ready': 0.0, 'hbhec_ready': 0.9253184141862261, 'hbheb_ready': 2.186799265381798, 'tecm_ready': 4.58632363487294, 'tecp_ready': 5.114475256636913, 'fpix_ready': 5.218175031220868, 'bpix_ready': 5.299040548024692, 'tibtid_ready': 5.4394161876485, 'tob_ready': 5.4394161876485}
{'ECAL': 0.105466069610327, 'Tracker': 7.634742400806714, 'HCAL': 9.792677179175847, 'L1T': 14.114422092689713, 'JetMET': 140.82375439199643, 'HLT': 150.2203147276383}
{'ECAL ': 0.105466069610327, 'Tracker L1T ': 0.1277208540582, 'L1T JetMET ': 0.44814739628689, 'Tracker JetMET ': 0.634884170662604, 'HCAL HLT JetMET ': 0.9253184141862261, 'L1T ': 3.1959478029753288, 'Tracker ': 6.872137376085911, 'HCAL ': 8.867234980253851, 'L1T HLT ': 10.342482254633524, 'JetMET ': 19.498335404148378, 'HLT ': 19.635445052106274, 'HLT JetMET ': 119.31706900671246}
{'ECAL ': 0.105466069610327, 'L1T ': 3.1959478029753288, 'Tracker ': 6.872137376085911, 'HCAL ': 8.867234980253851, 'JetMET ': 19.498335404148378, 'HLT ': 19.635445052106274, 'Mixed': 131.7957458812755}
{'L1T ': 0.01682340656178748, 'Tracker ': 0.03617479638394494, 'HCAL ': 0.04667695104808496, 'JetMET ': 0.10263885520179604, 'HLT ': 0.1033605976999031, 'Mixed': 0.6937702217822616}
{'L1T ': 1.6823406561787477, 'Tracker ': 3.6174796383944945, 'HCAL ': 4.667695104808496, 'L1T HLT ': 5.444262377057206, 'JetMET ': 10.263885520179604, 'HLT ': 10.336059769990312, 'HLT JetMET ': 62.80827114235168}
{'tracker-track': 0.33140069754988, 'tracker-pixel': 4.16094468304367, 'tracker-strip': 4.58632363487294, 'tecm_ready': 4.58632363487294, 'tecp_ready': 5.114475256636913, 'fpix_ready': 5.218175031220868, 'bpix_ready': 5.299040548024692, 'tibtid_ready': 5.4394161876485, 'tob_ready': 5.4394161876485}
{'ecal-es': 0.0, 'ecal-ecal': 0.105466069610327}
{'hbhea_ready': 0.0, 'hf_ready': 0.0, 'ho_ready': 0.0, 'hbhec_ready': 0.9253184141862261, 'hbheb_ready': 2.186799265381798, 'hcal-hcal': 6.680559499607825}
{'muon-muon': 0.0, 'csc-csc': 0.0, 'dt-dt': 0.0}
{'l1t-l1tcalo': 14.114422092689713, 'l1t-l1tmu': 14.114422092689713}
{'hlt-hlt': 150.2203147276383}
{'jetmet-jetmet': 140.82375439199643}
{'egamma-egamma': 0.0}
defaultdict(<class 'str'>, {'Mixed': 'brown', 'Tracker ': 'purple', 'ECAL ': 'red', 'HCAL ': 'green', 'Muon ': 'orange', 'L1T ': 'blue', 'HLT ': 'pink', 'JetMET ': 'gray', 'EGamma ': 'olive'})
['L1T ', 'Tracker ', 'HCAL ', 'JetMET ', 'HLT ', 'Mixed']
The png files are in the directory /afs/cern.ch/user/s/syu/scripts/runregistry/figures_eraG
The script produce_lumilossplots.sh has produced luminosity loss plots and will stop now
